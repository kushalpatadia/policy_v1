nbs.modules.Table=nbs.declare(nbs.modules._Base,{initialise:function(n,t){var i=$("html");this.inherited.apply(this,arguments);this.$el=n;this.opts=t=$.extend(!0,{index:null,sortable:!1,dynamicRows:!1,tableName:"default",classes:{ascending:"ascending",descending:"descending",notSortable:"notSortable"},analytics:{tableType:"Generic table",productCategory:"no-product-category-set",actionName:"Column Sort",columnHeader:"no-header-text"},jStorage:{timeout:36e5},isColumnSortCached:!1,cachedColumnIndex:null,cachedSortOrder:null},t);this.$table=this.$el.find("table");this.$thead=this.$table.find("thead:first");this.$tbody=this.$table.find("tbody:first");this.$headers=this.$table.find("th");this.$rows=this.$tbody.find("tr");i.hasClass("no-overflowscrolling")&&i.hasClass("touch")&&(this.iScroll=new iScroll(this.$table.parent()[0],{vScroll:!1,hScrollbar:!1,vScrollbar:!1,bounce:!1,onBeforeScrollStart:function(n){nbs.overlayManager.close();this.absDistX>this.absDistY+5&&n.preventDefault()}}));nbs.dispatcher.on("window/resize",nbs.util.hitch(this,"_resizeHandler"));nbs.util.defer(function(){this._resizeHandler()},this,1e3)},_resizeHandler:function(){nbs.util.defer(function(){this.iScroll&&this.iScroll.refresh()},this)},startup:function(){var t,i,n,r;this.$table=this.$el.find("table");this.$thead=this.$table.find("thead:first");this.$tbody=this.$table.find("tbody:first");this.$headers=this.$table.find("th");this.$rows=this.$tbody.find("tr");t=this.opts.tableName+"_cachedColumnIndex";i=this.opts.tableName+"_cachedSortOrder";typeof $.jStorage!="undefined"&&(this.opts.isColumnSortCached=$.jStorage.get("isColumnSortCached"),this.opts.cachedColumnIndex=$.jStorage.get(t),this.opts.cachedSortOrder=$.jStorage.get(i));this.opts.sortable&&(this.index=null,this.opts.isColumnSortCached&&(this.index=this.opts.cachedColumnIndex),this.rows=this._getRowData(),this._bindEvents(),n=$('<div class="sortingIcons" aria-label="Sort table by this column"><\/div>'),n.append('<span class="descIcon" data-icon="&#xe0e7;" aria-label="Sort descending"><\/span>'),n.append('<span class="ascIcon" data-icon="&#xe0bd;" aria-label="Sort ascending"><\/span>'),r=this.opts.classes,this.$headers.each(function(){$(this).hasClass(r.notSortable)||$(this).children("div.headerInner").append(n.clone())}),this.opts.isColumnSortCached?this.opts.cachedColumnIndex!=null&&this.toggleAsCached(this.opts.cachedColumnIndex,this.opts.cachedSortOrder):this.opts.index!==null&&this.toggle(opts.index))},_getRowData:function(){var t=this,n=[];return this.$table=this.$el.find("table"),this.$thead=this.$table.find("thead:first"),this.$tbody=this.$table.find("tbody:first"),this.$headers=this.$table.find("th"),this.$rows=this.$tbody.find("tr"),this.$rows.each(function(i){n[i]={$el:$(this),cells:[]};$(this).find("td, th").each(function(){n[i].cells.push(t._getSortableValue($(this)))})}),n},_getSortableValue:function(n){var t=n.data("nbs-sort-value");return typeof t=="undefined"&&(t=n.text().toLowerCase()),t},_bindEvents:function(){var n=this,t;this.$headers.each(function(i){$(this).hasClass(n.opts.classes.notSortable)||($("html").hasClass("ie")&&$(this).is("[tabindex=0]")&&$(this).removeAttr("tabindex"),$(this).on("touchstart",function(n){n.stopPropagation()}).mouseup(function(){t=!0}).keyup(function(r){t=!1;var u=r||window.event;u=u.keyCode;u==13&&(r.preventDefault(),n._clickHandler(r,i))}).click(function(r){r.preventDefault();n._clickHandler(r,i);t&&$(this).blur()}))})},_clickHandler:function(n,t){var i=this.$headers.eq(t).find('[data-nbs-module="Tooltip"]');(i.size()==0||nbs.dom.isTargetOutside(i,n))&&this.toggle(t)},toggle:function(n){var t=this._getOrder(n);if(this._setClasses(n,t),this.opts.isColumnSortCached){var i=this.opts.tableName+"_cachedColumnIndex",r=this.opts.tableName+"_cachedSortOrder",u=this.opts.jStorage.timeout;typeof $.jStorage!="undefined"&&($.jStorage.set(i,n),$.jStorage.setTTL(i,u),$.jStorage.set(r,t),$.jStorage.setTTL(r,u))}this.opts.dynamicRows&&(this.$table=this.$el.find("table"),this.$tbody=this.$table.find("tbody:first"),this.$rows=this.$tbody.find("tr"),this.rows=this._getRowData());this.sort(n,t);this.index=n;this._sendSortAnalytics()},toggleAsCached:function(n,t){this._setClasses(n,t);this.opts.dynamicRows&&(this.$rows=this.$tbody.find("tr"),this.rows=this._getRowData());this.sort(n,t);this.index=n;this._sendSortAnalytics()},refreshSortOrder:function(){var n=this.index,t=this._getCurrentOrder(n);this.opts.dynamicRows&&(this.$rows=this.$tbody.find("tr"),this.rows=this._getRowData());this.sort(n,t)},_getColumnHeader:function(){var n=this.$headers.eq(this.index).find("p:visible"),t=this.opts.analytics.columnHeader;return n.size()>0&&(t=n.text()),t},sort:function(n,t){var s=this._getSortFnc(t),i=this.rows,u,r,e,f,o;for(u=0,len=i.length;u<len;u++)for(r=0;r<len-1;r++)s(i[r].cells[n],i[r+1].cells[n])&&(e=i[r+1],i[r+1]=i[r],i[r]=e);for(f=$("<tbody />"),u=0;u<i.length;u++)o=i[u],f.append(o.$el.detach());this.$tbody.html(f.contents());this.trigger("sort",n,t)},_sendSortAnalytics:function(){var n=[];n.push(this.opts.analytics.tableType);n.push(this.opts.analytics.productCategory);n.push(this.opts.analytics.actionName);n.push(this._getColumnHeader());nbs.analytics.customLink(n.join("|"))},_getSortFnc:function(n){var t=function(n,t){return n>t};return n==="descending"&&(t=function(n,t){return n<t}),t},_getOrder:function(n){var i=this.$headers.eq(n),t="ascending";return i.hasClass(this.opts.classes.ascending)&&(t="descending"),t},_getCurrentOrder:function(n){var i=this.$headers.eq(n),t="descending";return i.hasClass(this.opts.classes.ascending)&&(t="ascending"),t},_setClasses:function(n,t){var i=this.opts.classes,r=this.$headers.eq(n);this.$headers.eq(this.index).removeClass(i.descending+" "+i.ascending);t==="descending"?r.addClass(i.descending):r.addClass(i.ascending)}});nbs.modules.StickyColumn=nbs.declare(nbs.modules.Table,{initialise:function(){this.inherited.apply(this,arguments);this._createClone();this.appended=!1;this.headerWidth=0;nbs.dispatcher.on("window/resize",nbs.util.hitch(this,"_resizeHandler"));var n=this;$(window).load(function(){n._resizeHandler();setTimeout(function(){n._resizeHandler()},1e3)})},_createClone:function(){var i=this.$table,n=i.clone().addClass("cloned"),t=$('<div class="scrollable" />');n.find("td").remove();n.css({float:"left",position:"relative",zIndex:2});t.css({float:"left",width:"100%"});t.css({overflowX:"auto"});this.$clone=n;this.$scrollable=t},_resizeClone:function(){var i=this.$headers,n,t;this.$clone.find("th").each(function(r){n=i.eq(r);t=$(this);t.width(n.width());t.height(n.height())});this.headerWidth=i.eq(0).outerWidth()+23;this.$clone.width(this.headerWidth);this.$scrollable.css({marginLeft:-(this.$clone.width()+1)-0})},_appendClone:function(){var n=this.$table.parent();n.append(this.$clone);this.$clone.after(this.$scrollable);this.$scrollable.append(this.$table);this._resizeClone();this.appended=!0},_removeClone:function(){this.$clone.remove();this.$scrollable.remove();this.$el.append(this.$table);this.appended=!1},_resizeHandler:function(){var n=this.$table.width()>this.$el.width();n?this.appended?this._resizeClone():this._appendClone():this._removeClone()}});nbs.modules.StickyHeader=nbs.declare(nbs.modules.Table,{initialise:function(){this.inherited.apply(this,arguments);this.loaded=!1;this.$clone=$();this.$clonedHeaders=$();nbs.respond.on("change",nbs.util.hitch(this,"_responsiveHandler"));this._responsiveHandler()},_responsiveHandler:function(){nbs.util.defer(function(){if(!nbs.isLessThanTablet()&&!this.loaded){this.$firstRow=this.$tbody.find("tr:first").find("td");this.appended=!1;this.scrollable=!1;nbs.dispatcher.on("window/resize",nbs.util.hitch(this,"_resizeHandler"));nbs.dom.$window.scroll(nbs.util.hitch(this,"_ScrollHandler"));this._ScrollHandler();this.loaded=!0}},this)},_appendClone:function(){this.appended=!0;this.$clone=this.$thead.clone();this.$clonedHeaders=this.$clone.find("th");this.$table.append(this.$clone);this.$thead.addClass("fixed").css({position:"fixed",top:0,left:this.$el.offset().left,zIndex:1});this._resizeHandler()},_removeClone:function(){this.appended&&(this.$clone.remove(),this.$clone=$(),this.$clonedHeaders=$(),this.$thead.removeClass("fixed").css("position","static"),this.appended=!1)},_ScrollHandler:function(){if(this.scrollable||nbs.isLessThanTablet()){this.$table.addClass("willScroll");this.$table.removeClass("wontScroll");this._removeClone();return}this.$table.removeClass("willScroll");this.$table.addClass("wontScroll");var n=nbs.dom.$window.scrollTop(),t=this.$table.offset().top,i=t+this.$table.height()-this.$thead.height();n>t&&n<=i?this.appended||this._appendClone():this._removeClone()},_resizeHandler:function(){this.inherited.apply(this,arguments);var n=this;this.scrollable=this.$el[0].scrollWidth>this.$el[0].clientWidth;this.iScroll&&(this.scrollable=this.iScroll.maxScrollX<0);this.scrollable||(this.$headers.each(function(t){$(this).width(n.$clonedHeaders.eq(t).width())}),this.$thead.css({width:this.$el.width(),left:this.$table.offset().left}));this._ScrollHandler()}});nbs.modules.MoreDropdown=nbs.declare(nbs.modules._Base,{initialise:function(n,t){this.inherited.apply(this,arguments);this.opts=$.extend({menu:"div.moreNav"},t);this.$menu=n.children(this.opts.menu).attr("aria-hidden",!0);this.isOpen=!1;this.$trigger=n.children("a");this.$trigger.click(nbs.util.hitch(this,"_clickHandler"))},_clickHandler:function(n){n.preventDefault();this.toggle()},toggle:function(){this.isOpen?this.close():nbs.util.defer(function(){this.open()},this)},open:function(){this.$el.addClass("open");this.$menu.attr("aria-hidden",!1);this.isOpen=!0;nbs.overlayManager.setCurrentOverlay(this)},close:function(){this.$el.removeClass("open");this.$menu.attr("aria-hidden",!0);this.isOpen=!1}});nbs.modules.SocialSharing=nbs.declare(nbs.modules._Base,{initialise:function(n){this.inherited.apply(this,arguments);n.find("a[data-url]").click(this.handleLinkClick)},handleLinkClick:function(n){n.preventDefault();var t=$(this),i=t.data("url"),r=t.data("width")||"500",u=t.data("height")||"500";window.open(i,"n","scrollbars=1,toolbar=0,resizable=1,status=0,width="+r+",height="+u).focus()}}),function(){nbs.modules.Twisty=nbs.declare(nbs.modules._Base,{initialise:function(n){this.inherited.apply(this,arguments);this.$twisty=n.find(".twisty")},startup:function(){this.inherited.apply(this,arguments);this.twisty=nbs.registry.get(this.$twisty);this._bindEvents()},_bindEvents:function(){nbs.dispatcher.on("showHide/open",nbs.util.hitch(this,"_analyticsHandler"));nbs.dispatcher.on("showHide/openAll",nbs.util.hitch(this,"_analyticsHandlerOpenAll"))},_analyticsHandler:function(n){if(n.module==this.twisty){var i=n.section.find(this.twisty.opts.selectors.sectionTitle).clone().find(".srText").remove().end(),t=nbs.tidying.sanitizeString($.trim(i.text()));t=t.length<=0?"no link text":t;s.tl("true","o","Twisty|No Heading|"+t)}},_analyticsHandlerOpenAll:function(n){if(n.module==this.twisty&&typeof n.event=="object"&&n.event.currentTarget!=null){var t=nbs.tidying.sanitizeString($.trim($(n.event.currentTarget).clone().find(".srText").remove().end().text()));t=t.length<0?"no link text":t;s.tl("true","o","Twisty|"+t)}}})}(),function(){nbs.modules.Concertina=nbs.declare(nbs.modules._Base,{initialise:function(n){this.inherited.apply(this,arguments);this.$concertina=n.find("[data-nbs-module='ShowHide']")},startup:function(){this.inherited.apply(this,arguments);this.concertina=nbs.registry.get(this.$concertina);this._bindEvents()},_bindEvents:function(){nbs.dispatcher.on("showHide/open",nbs.util.hitch(this,"_analyticsHandler"));nbs.dispatcher.on("showHide/openAll",nbs.util.hitch(this,"_analyticsHandlerOpenAll"))},_analyticsHandler:function(n){if(n.module==this.concertina){var i=n.section.find(this.concertina.opts.selectors.sectionTitle).clone().find(".srText").remove().end(),t=nbs.tidying.sanitizeString($.trim(i.text()));t=t.length<=0?"no link text":t;s.tl("true","o","Concertina|No Heading|"+t)}},_analyticsHandlerOpenAll:function(n){if(n.module==this.concertina&&typeof n.event=="object"&&n.event.currentTarget!=null){var t=nbs.tidying.sanitizeString($.trim($(n.event.currentTarget).clone().find(".srText").remove().end().text()));t=t.length<0?"no link text":t;s.tl("true","o","Concertina|"+t)}}})}();nbs.modules.TabsLight=nbs.declare(nbs.modules._Base,{initialise:function(n,t){this.inherited.apply(this,arguments);this.$el=n;this.opts=t=$.extend(!0,{selectors:{sections:"section.tabSection",firstSection:"section.tabSection:eq(0)",nav:"nav.tabs",activeSection:"section.tabSection.active",content:"div.tabContent",sectionTitle:".sectionTitle",sectionTitleLink:".sectionTitle a",tabsNext:".contentSection .selectorTabs .columnSet .col4 .tabs .tab",tabSection:".tabSection"},classes:{active:"active"},overrideClosedFirstTabOnMobile:!1},t);this.descendents=[];this.$sections=this.$(t.selectors.sections);this.$firstSection=this.$(t.selectors.firstSection);this.$tabs=n.children(t.selectors.nav).find("li");this.$activeSection=n.children(t.selectors.activeSection);this.$activeTabContent=this.$activeSection.children(t.selectors.content);this.$activeSectionLink=this.$activeSection.children(t.selectors.sectionTitle).children("a");this.$tabsNext=this.$(t.selectors.tabsNext);this.$tabSection=this.$(t.selectors.tabSection);this.$activeSectionLink.click(nbs.util.hitch(this,"_handleActiveSectionLinkClick"));this.firstMobileTabExpanded=!1;this.isFirstTabInCollection=this.$sections.index(this.$activeSection)==0;this.$firstTwistyLinkOnMobile=this.$firstSection.find(t.selectors.sectionTitleLink);nbs.dispatcher.on("nbs/windowload",nbs.util.hitch(this,"_tabCustom"));this.$tabsNext.on("keydown",nbs.util.hitch(this,"_tabsKeyDown"));this.$tabSection.on("keydown",nbs.util.hitch(this,"_tabsKeyDown"));!this.opts.overrideClosedFirstTabOnMobile&&this.isFirstTabInCollection&&this._handleFirstSection()},startup:function(){nbs.respond.on("change",nbs.util.hitch(this,"_responsiveHandler"));this.descendents=nbs.registry.getDescendents(this.$activeSection)},_checkFirstTab:function(){var n=this;this.$firstTwistyLinkOnMobile.on("click",function(){n.firstMobileTabExpanded=n.$firstSection.hasClass("active")?!0:!1})},_handleFirstSection:function(){var t=this,n;(nbs.isMobile()||nbs.isSmallTablet())&&(n=location.href.indexOf("#tab"),n==-1?(this.$sections.eq(0).removeClass("active"),typeof s!="undefined"&&(s.pageName+=":collapsed")):(this.$sections.eq(0).addClass("active"),t.firstMobileTabExpanded=!0,this._open()),this._checkFirstTab())},_handleActiveSectionLinkClick:function(n){n.preventDefault();this._toggle()},_toggle:function(){var t=this.$activeSection.hasClass(this.opts.classes.active),i=nbs.parser.getOptions(this.$activeSectionLink,"nbs-analytics"),n={contextData:{}};n.contextData.navigation=i.navigation;t?(s.pageName+=":collapsed",nbs.analytics.send(n),this._close()):(s.pageName=s.pageName.replace(":collapsed",""),nbs.analytics.send(n),this._open())},_open:function(){if(this.$activeSection.addClass(this.opts.classes.active),this.$activeTabContent.show(),this.descendents.length>0)for(var n=0;n<this.descendents.length;n++)this.descendents[n].trigger("ancestor-opened")},_close:function(){if(this.$activeSection.removeClass(this.opts.classes.active),this.$activeTabContent.hide(),this.descendents.length>0)for(var n=0;n<this.descendents.length;n++)this.descendents[n].trigger("ancestor-closed")},_responsiveHandler:function(n){var t=this,i,r;this._checkFirstTab();i=this.$tabs.is(":visible");r=this.$activeSection.hasClass(this.opts.classes.active);n=="mobile"||n=="smallTablet"?!t.firstMobileTabExpanded&&t.isFirstTabInCollection&&(t.opts.overrideClosedFirstTabOnMobile||this._close()):i&&!r&&this._open()},_tabCustom:function(){var n=this.$tabsNext;n.each(function(){var n=$(this);n.find(".tabTitle").attr("tabindex","-1");n.hasClass("active")&&n.find(".tabTitle").removeAttr("tabindex","-1")})},_tabsKeyDown:function(n){var i=n.which,t=this.$tabsNext;switch(i){case 27:t.each(function(){var n=$(this);n.find(".tabTitle").removeAttr("tabindex","-1");n.hasClass("active")&&n.find("a").focus()});break;case 13:t.each(function(){var n=$(this);n.find(".tabTitle").attr("tabindex","-1");n.hasClass("active")&&n.find(".tabTitle").removeAttr("tabindex","-1")})}}});nbs.modules.printIcon=nbs.declare(nbs.modules._Base,{initialise:function(n){this.inherited.apply(this,arguments);var t=this;this.$trigger=n.find("button");this._bindEvents()},_bindEvents:function(){this.$trigger.click(nbs.util.hitch(this,"_clickHandler"))},_clickHandler:function(n){window.print();n.preventDefault()}});